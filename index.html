<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, viewport-fit=cover">

    <title>Visor TiQAL</title>
    <link rel="stylesheet" href="style.css">

    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1a1a1a">
</head>

<body>
    <header id="main-header">
        <div class="brand">
            <img src="Logo-Tiqal-Blanco.png" alt="Logo" class="logo-img">
            <span>Visor Dise침o Lineal</span>
        </div>
        <div class="km-wrapper">
            <div class="km-box label-box">PK</div>
            <div class="km-box input-box">
                <input type="text" id="kmInput" value="ESPERANDO ARCHIVO..." title="Presiona Enter para buscar">
            </div>
        </div>
        <div class="header-tools">
            <button class="btn-load" onclick="document.getElementById('fileInput').click()">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round" style="margin-right: 6px;">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="17 8 12 3 7 8"></polyline>
                    <line x1="12" y1="3" x2="12" y2="15"></line>
                </svg>
                SUBIR DATA
            </button>
        </div>
        <input type="file" id="fileInput" style="display:none" accept=".TiQAL">
    </header>

    <div id="app-container">
        <aside id="sidebar">
            <button class="tab-btn active" onclick="changeLayout('layout-seccion')">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M2 12h20"></path>
                    <path d="M12 2v20"></path>
                    <path d="M5 5l14 14"></path>
                </svg>
                <span>SECCI칍N</span>
            </button>
            <button class="tab-btn" onclick="changeLayout('layout-planta')">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"></polygon>
                    <line x1="8" y1="2" x2="8" y2="18"></line>
                    <line x1="16" y1="6" x2="16" y2="22"></line>
                </svg>
                <span>PLANTA</span>
            </button>
            <button class="tab-btn" onclick="changeLayout('layout-perfil')">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                </svg>
                <span>PERFIL</span>
            </button>

            <div class="separator"></div>

            <button class="tab-btn" onclick="changeLayout('layout-multi')">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
                <span>MULTI</span>
            </button>

            <div class="separator"></div> <button class="tab-btn" onclick="capturaInteligente()" title="Guardar Imagen">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2"
                    stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                    <path
                        d="M5 7h1a2 2 0 0 0 2 -2a1 1 0 0 1 1 -1h6a1 1 0 0 1 1 1a2 2 0 0 0 2 2h1a2 2 0 0 1 2 2v9a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-9a2 2 0 0 1 2 -2">
                    </path>
                    <path d="M9 13a3 3 0 1 0 6 0a3 3 0 0 0 -6 0"></path>
                </svg>
                <span>FOTO</span>
            </button>

            <div style="flex-grow: 1;"></div>

            <button class="tab-btn btn-settings" onclick="toggleSettings()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="3"></circle>
                    <path
                        d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 5 12a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                    </path>
                </svg>
                <span>AJUSTES</span>
            </button>
        </aside>

        <main id="main-dashboard" class="layout-seccion">

            <section class="panel" id="panel-planta">
                <header>VISTA DE PLANTA</header>
                <div class="canvas-wrapper">
                    <canvas id="canvasPlanta"></canvas>

                    <!-- FLECHA NORTE (Estilo Comp치s Moderno) -->
                    <div class="north-arrow" title="Norte">
                        <svg width="60" height="60" viewBox="0 0 100 100" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <!-- C칤rculo Exterior -->
                            <circle cx="50" cy="50" r="45" stroke="#94a3b8" stroke-width="2"
                                fill="rgba(15, 23, 42, 0.5)" />
                            <circle cx="50" cy="50" r="40" stroke="#cbd5e1" stroke-width="1" stroke-dasharray="4 4" />

                            <!-- Estrella (Norte/Sur/Este/Oeste) -->
                            <path d="M50 10 L60 40 L90 50 L60 60 L50 90 L40 60 L10 50 L40 40 Z" fill="#1e293b"
                                stroke="#cbd5e1" stroke-width="1" />

                            <!-- Aguja Norte (Principal) -->
                            <path d="M50 10 L60 50 L40 50 Z" fill="#E91E63" stroke="none" />
                            <!-- Magenta para resaltar -->
                            <path d="M50 10 L50 50" stroke="#cbd5e1" stroke-width="1" />

                            <!-- Aguja Sur (Secundaria) -->
                            <path d="M50 90 L60 50 L40 50 Z" fill="#cbd5e1" stroke="none" />

                            <!-- Letra N -->
                            <text x="50" y="28" text-anchor="middle" font-family="Arial, sans-serif" font-weight="bold"
                                font-size="14" fill="#E91E63">N</text>
                        </svg>
                    </div>

                    <div class="panel-controls">
                        <button class="btn-reset-mini" title="M치s Herramientas">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <circle cx="12" cy="12" r="1"></circle>
                                <circle cx="19" cy="12" r="1"></circle>
                                <circle cx="5" cy="12" r="1"></circle>
                            </svg>
                        </button>
                        <button class="btn-reset-mini" onclick="resetView('planta')" title="Centrar Planta">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path>
                                <path d="M3 3v5h5"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </section>

            <section class="panel" id="panel-perfil">
                <header>VISTA DE PERFIL LONGITUDINAL</header>
                <div class="canvas-wrapper">
                    <canvas id="canvasPerfil"></canvas>
                    <div class="panel-controls">
                        <button class="btn-reset-mini" title="M치s Herramientas">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <circle cx="12" cy="12" r="1"></circle>
                                <circle cx="19" cy="12" r="1"></circle>
                                <circle cx="5" cy="12" r="1"></circle>
                            </svg>
                        </button>
                        <button class="btn-reset-mini" onclick="resetView('perfil')" title="Centrar Perfil">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path>
                                <path d="M3 3v5h5"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </section>

            <section class="panel" id="panel-seccion">
                <header>VISTA DE SECCI칍N TRANSVERSAL</header>
                <div id="canvasContainer" class="canvas-wrapper">
                    <canvas id="visorCanvas"></canvas>

                    <!-- NUEVO PANEL DE MEDICI칍N (TOOLBAR) -->
                    <div id="hud-panel" class="hud-panel">
                        <div class="hud-tools">
                            <!-- HERRAMIENTA DE MEDICI칍N (Dropdown) -->
                            <!-- HERRAMIENTA DE MEDICI칍N (Split Button) -->
                            <div class="hud-btn-group">
                                <button class="hud-btn" id="btnMeasureAction" onclick="toggleMeasureAction()"
                                    title="Activar/Desactivar Medici칩n">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                                        <circle cx="12" cy="10" r="3"></circle>
                                    </svg>
                                </button>
                                <div class="tool-dropdown">
                                    <button class="hud-btn" id="btnMeasureMenu" onclick="toggleMeasureDropdown(event)"
                                        title="Cambiar Herramienta">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                            stroke-linejoin="round">
                                            <polyline points="6 9 12 15 18 9"></polyline>
                                        </svg>
                                    </button>
                                    <div class="dropdown-content" id="measureDropdown">
                                        <a href="#" onclick="selectMeasureTool('point')" id="opt-point">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                                stroke-linejoin="round"
                                                style="margin-right: 8px; vertical-align: middle;">
                                                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                                                <circle cx="12" cy="10" r="3"></circle>
                                            </svg>
                                            Punto
                                        </a>
                                        <a href="#" onclick="selectMeasureTool('dist')" id="opt-dist">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                                stroke-linejoin="round"
                                                style="margin-right: 8px; vertical-align: middle;">
                                                <path d="M2 12h20"></path>
                                                <path d="M2 12v4"></path>
                                                <path d="M22 12v4"></path>
                                                <path d="M12 12v4"></path>
                                            </svg>
                                            Distancia
                                        </a>
                                        <a href="#" onclick="selectMeasureTool('slope')" id="opt-slope">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                                stroke-linejoin="round"
                                                style="margin-right: 8px; vertical-align: middle;">
                                                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                                                <polyline points="17 6 23 6 23 12"></polyline>
                                            </svg>
                                            Pendiente
                                        </a>
                                    </div>
                                </div>
                            </div>

                            <div class="hud-sep"></div>

                            <!-- SNAP (Im치n) -->
                            <button class="hud-btn" id="btnSnap" onclick="toggleSnap()" title="Snap (Im치n)">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M5 19V5h14"></path> <!-- Esquina -->
                                    <rect x="3" y="3" width="6" height="6" fill="currentColor" fill-opacity="0.3">
                                    </rect> <!-- Marcador V칠rtice -->
                                </svg>
                            </button>
                        </div>
                        <div class="hud-values">
                            <!-- Modo Punto (Default) -->
                            <div id="info-point">
                                <span class="hud-label">Z:</span> <span id="hudY">0.000</span>
                                <span class="hud-label">X:</span> <span id="hudX">0.000</span>
                            </div>
                            <!-- Modo Distancia -->
                            <div id="info-dist"
                                style="display: none; flex-direction: column; align-items: flex-start; gap: 4px;">
                                <div class="hud-row">游늸1: <span id="distP1">--</span></div>
                                <div class="hud-row">游늸2: <span id="distP2">--</span></div>
                                <div class="hud-sep-h"
                                    style="width: 100%; height: 1px; background: rgba(255,255,255,0.1); margin: 2px 0;">
                                </div>
                                <div class="hud-row" style="width: 100%; justify-content: flex-end;">
                                    <span class="highlight"
                                        style="color: #00ffcc; font-weight: bold; display: flex; align-items: center; gap: 5px;">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                            stroke-linejoin="round">
                                            <path d="M2 12h20"></path>
                                        </svg>
                                        <span id="distVal">0.000m</span>
                                    </span>
                                </div>
                            </div>
                            <!-- Modo Pendiente -->
                            <div id="info-slope"
                                style="display: none; flex-direction: column; align-items: flex-start;">
                                <div class="hud-row">游늸1: <span id="slopeP1">--</span></div>
                                <div class="hud-row">游늸2: <span id="slopeP2">--</span></div>
                                <div class="hud-sep-h"></div>
                                <div class="hud-row">
                                    <span class="highlight"
                                        style="color: #ff9900; font-weight: bold; margin-right: 10px; display: flex; align-items: center; gap: 5px;">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                            stroke-linejoin="round">
                                            <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                                        </svg>
                                        <span id="slopeVal">0.0%</span>
                                    </span>
                                    <span>Talud: <span id="slopeRatio">--:1</span></span>
                                </div>
                                <div class="hud-row">
                                    <span style="margin-right: 10px;">풊X: <span id="slopeH">0.00</span></span>
                                    <span>풊Z: <span id="slopeV">0.00</span></span>
                                </div>
                                <div class="hud-row">
                                    <span class="highlight">L: <span id="slopeReal">0.00</span></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="panel-controls">
                        <button class="btn-reset-mini" title="M치s Herramientas">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <circle cx="12" cy="12" r="1"></circle>
                                <circle cx="19" cy="12" r="1"></circle>
                                <circle cx="5" cy="12" r="1"></circle>
                            </svg>
                        </button>
                        <!-- Bot칩n Snap eliminado de aqu칤 -->
                        <button class="btn-reset-mini" onclick="resetView('seccion')" title="Centrar">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path>
                                <path d="M3 3v5h5"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <footer id="main-footer">
        <div class="slider-wrapper">
            <input type="range" id="stationSlider" min="0" max="0" value="0">
            <div class="mobile-safe-area"></div>
        </div>
    </footer>

    <div id="settingsModal" class="modal-overlay" style="display: none;">
        <div class="modal-content settings-box">
            <header class="modal-header">
                <div class="header-title">
                    <span>丘뙖잺 CONFIGURACI칍N</span>
                </div>
                <button class="btn-close" onclick="toggleSettings()">칑</button>
            </header>

            <div class="modal-body-layout">
                <aside class="settings-sidebar">
                    <button class="setting-tab active" onclick="openTab('tab-general')">General</button>
                    <button class="setting-tab" onclick="openTab('tab-planta')">Planta</button>
                    <button class="setting-tab" onclick="openTab('tab-perfil')">Perfil</button>
                    <button class="setting-tab" onclick="openTab('tab-seccion')">Secci칩n</button>
                    <button class="setting-tab" onclick="openTab('tab-multi')">Multi-Vista</button>
                </aside>

                <main class="settings-main">
                    <div id="tab-general" class="tab-content active">
                        <div class="setting-group">
                            <label>Apariencia</label>
                            <div class="setting-row">
                                <span>Modo D칤a / Noche</span>
                                <label class="switch">
                                    <input type="checkbox" id="chkTheme" onchange="toggleTheme(this)">
                                    <span class="slider round"></span>
                                </label>
                            </div>
                        </div>
                        <div class="setting-group">
                            <label>Textos Globales</label>
                            <div class="setting-row">
                                <span>Escala de Texto</span>
                                <input type="number" id="cfgTextScale" value="1.0" step="0.1" min="0.5" max="5.0"
                                    class="input-number">
                            </div>
                        </div>
                    </div>

                    <div id="tab-planta" class="tab-content">
                        <div class="setting-group">
                            <label>Etiquetado (Kilometraje)</label>
                            <div class="setting-row">
                                <span>Mostrar Etiquetas Pk</span>
                                <input type="checkbox" id="chkPlantaLabels" checked>
                            </div>
                            <div class="setting-row">
                                <span>Mostrar Estacado</span> <input type="checkbox" id="chkPlantaTicks" checked>
                            </div>
                            <div class="setting-row">
                                <span>Intervalo Texto (Mayores)</span>
                                <input type="number" id="cfgPlantaMajor" value="1000" step="100" class="input-number">
                            </div>
                            <div class="setting-row">
                                <span>Intervalo Ticks (Menores)</span>
                                <input type="number" id="cfgPlantaMinor" value="100" step="50" class="input-number">
                            </div>
                        </div>

                        <div class="setting-group">
                            <label>Grilla y Coordenadas</label>
                            <div class="setting-row">
                                <span>Intervalo General (m)</span>
                                <input type="number" id="cfgGridPlanta" value="200" step="50" class="input-number">
                            </div>
                            <div class="setting-row">
                                <span>Intervalo Miniatura (m)</span>
                                <input type="number" id="cfgGridPlantaMulti" value="500" step="100"
                                    class="input-number">
                            </div>
                            <div class="setting-row">
                                <span>Mostrar Grilla</span>
                                <input type="checkbox" id="chkShowGridPlanta" checked>
                            </div>
                        </div>

                        <div class="setting-group">
                            <label>Gestor de Elementos</label>
                            <div id="layers-planta-container">
                            </div>
                        </div>
                    </div>

                    <div id="tab-perfil" class="tab-content">
                        <div class="setting-group">
                            <label>Visualizaci칩n</label>
                            <div class="setting-row">
                                <span>Exageraci칩n Vertical</span>
                                <select id="cfgExajPerfil" class="input-select">
                                    <option value="1">1x (Real)</option>
                                    <option value="5">5x</option>
                                    <option value="10" selected>10x (Standard)</option>
                                    <option value="20">20x</option>
                                </select>
                            </div>

                            <div class="setting-row">
                                <span>Seguir a (Punto Rojo)</span>
                                <select id="cfgTargetPerfil" class="input-select">
                                    <option value="auto">Autom치tico</option>
                                </select>
                            </div>
                        </div>

                        <div class="setting-group">
                            <label>Grillas</label>
                            <div class="setting-row">
                                <span>Intervalo PK (Gral)</span>
                                <input type="number" id="cfgGridPerfilK" value="500" step="50" class="input-number">
                            </div>
                            <div class="setting-row">
                                <span>Intervalo PK (Mini)</span>
                                <input type="number" id="cfgGridPerfilKMulti" value="1000" step="100"
                                    class="input-number">
                            </div>
                            <div class="setting-row">
                                <span>Intervalo Cota (Gral)</span>
                                <input type="number" id="cfgGridPerfilZ" value="10" step="1" class="input-number">
                            </div>
                            <div class="setting-row">
                                <span>Intervalo Cota (Mini)</span>
                                <input type="number" id="cfgGridPerfilZMulti" value="50" step="5" class="input-number">
                            </div>
                        </div>

                        <div class="setting-group">
                            <label>Gestor de Elementos</label>
                            <div id="layers-perfil-container">
                            </div>
                        </div>
                    </div>

                    <div id="tab-seccion" class="tab-content">
                        <div class="setting-group">
                            <label>Grilla Transversal</label>
                            <div class="setting-row">
                                <span>Intervalo Desfase (X)</span>
                                <input type="number" id="cfgGridSeccionX" value="5" step="1" class="input-number">
                            </div>
                            <div class="setting-row">
                                <span>Intervalo Elevaci칩n (Y)</span>
                                <input type="number" id="cfgGridSeccionY" value="5" step="1" class="input-number">
                            </div>
                        </div>

                        <div class="setting-group">
                            <label>Gestor de Elementos</label>
                            <div id="layers-seccion-container">
                            </div>
                        </div>
                    </div>

                    <div id="tab-multi" class="tab-content">
                        <div class="setting-group">
                            <label>Auto-Encuadre Inteligente</label>
                            <div class="setting-row">
                                <span>Activar Smart Zoom</span>
                                <input type="checkbox" id="chkMultiAutoZoom" checked>
                            </div>
                            <div class="setting-row">
                                <span>Ventana de Kil칩metros (+/-)</span>
                                <input type="number" id="cfgMultiWindow" value="2" step="1" min="1" max="10"
                                    class="input-number">
                            </div>
                            <div class="setting-row">
                                <small style="color: var(--text-muted); font-style: italic;">
                                    Define cu치ntos kil칩metros enteros hacia atr치s y adelante se mostrar치n en la vista
                                    miniatura.
                                </small>
                            </div>
                        </div>
                    </div>
                </main>
            </div>

            <footer class="modal-footer">
                <button class="btn-primary" onclick="applySettingsAndClose()">Guardar y Cerrar</button>
            </footer>
        </div>
    </div>

    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => console.log("SW registrado", reg.scope))
                    .catch(err => console.warn("Error al registrar SW", err));
            });
        }
    </script>

    <!-- PANTALLA DE BIENVENIDA (OVERLAY SEGURO) -->
    <div id="welcome-screen">
        <div class="welcome-content">
            <div class="logo-large">
                <img src="Logo-Tiqal-Blanco.png" alt="Logo TiQAL">
            </div>
            <h1>Bienvenido a Visor TiQAL</h1>
            <p>Herramienta para visualizaci칩n de geometr칤a en Dise침os Lineales</p>

            <div class="upload-area" onclick="document.getElementById('fileInput').click()">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="17 8 12 3 7 8"></polyline>
                    <line x1="12" y1="3" x2="12" y2="15"></line>
                </svg>
                <span>Haz clic para abrir un archivo .TiQAL</span>
            </div>
            <p class="subtext">Versi칩n 2.0 | Deep Space UI</p>
        </div>
    </div>

    <script src="js/state.js"></script>
    <script src="js/seccion.js"></script>
    <script src="js/planta.js"></script>
    <script src="js/perfil.js"></script>
    <script src="js/main.js"></script>
</body>

</html>